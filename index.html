<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Mini YouTube с JSON и соцсетями</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 900px; margin: auto; padding: 20px; }
    input[type="text"] { width: 70%; padding: 8px; font-size: 16px; }
    button { padding: 8px 12px; font-size: 16px; }
    .video-item { margin: 20px 0; }
    iframe { width: 100%; height: 360px; }
    .video-title { font-weight: bold; margin: 8px 0 4px; }
    .video-description { color: #555; }
    .socials {
      margin: 20px 0;
    }
    .social-icon {
      width: 40px;
      height: 40px;
      margin-right: 15px;
      vertical-align: middle;
      cursor: pointer;
      transition: transform 0.2s ease;
    }
    .social-icon:hover {
      transform: scale(1.2);
    }
  </style>
</head>
<body>
  <h1>Mini YouTube с JSON и соцсетями</h1>

  <div class="socials">
    <a href="https://t.me/MyTubeYouTube" target="_blank" rel="noopener noreferrer" title="Телеграм">
      <img class="social-icon" src="https://cdn-icons-png.flaticon.com/512/2111/2111646.png" alt="Telegram" />
    </a>
    <a href="https://discord.gg/hUczWKUhQP" target="_blank" rel="noopener noreferrer" title="Discord">
      <img class="social-icon" src="https://cdn-icons-png.flaticon.com/512/2111/2111370.png" alt="Discord" />
    </a>
  </div>
  
  <input id="searchInput" type="text" placeholder="Введите ключевые слова или ссылку на видео..." />
  <button onclick="searchVideos()">Искать</button>
  
  <div id="videos">Загрузка видео...</div>
  
  <script>
    let videosDB = [];

    async function loadVideos() {
      try {
        const res = await fetch('videos.json');
        videosDB = await res.json();
        searchVideos();
      } catch (e) {
        document.getElementById('videos').innerHTML = "Ошибка загрузки видео.";
        console.error(e);
      }
    }

    function extractVideoID(url) {
      const regex = /(?:youtube\.com\/.*v=|youtu\.be\/)([a-zA-Z0-9_-]{11})/;
      const match = url.match(regex);
      return match ? match[1] : null;
    }

    function searchVideos() {
      const queryRaw = document.getElementById("searchInput").value.trim();
      const query = queryRaw.toLowerCase();
      const container = document.getElementById("videos");

      container.innerHTML = "";

      const videoID = extractVideoID(queryRaw);

      if (videoID) {
        // Показываем видео по ссылке без проверки базы
        container.innerHTML = `
          <div class="video-item">
            <div class="video-title">Видео по ссылке</div>
            <iframe src="https://www.youtube.com/embed/${videoID}" frameborder="0" allowfullscreen></iframe>
            <div class="video-description">Это видео загружено по прямой ссылке.</div>
          </div>
        `;
        return;
      }

      const videos = query === "" 
        ? videosDB 
        : videosDB.filter(v => 
            v.title.toLowerCase().includes(query) || 
            v.description.toLowerCase().includes(query)
          );

      if (videos.length === 0) {
        container.innerHTML = "<p>Видео не найдены.</p>";
        return;
      }

      videos.forEach(video => {
        const div = document.createElement("div");
        div.className = "video-item";
        div.innerHTML = `
          <div class="video-title">${video.title}</div>
          <iframe src="https://www.youtube.com/embed/${video.id}" frameborder="0" allowfullscreen></iframe>
          <div class="video-description">${video.description}</div>
        `;
        container.appendChild(div);
      });
    }

    loadVideos();
  </script>
</body>
</html>
